<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Reader</title>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #6a82fb 0%, #fc5c7d 100%);
            --btn-gradient: linear-gradient(to right, #6a82fb, #b06ab3);
            --bg-light: #f4f4f4;
            --text-main: #333;
            --accent: #d4af37;
            --flip-speed: 0.8s;
        }

        body, html {
            margin: 0; padding: 0; height: 100%;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            overflow: hidden;
            background-color: var(--bg-light);
        }

        .hidden { display: none !important; }

        /* --- LANDING PAGE (Exact Screenshot Style) --- */
        #upload-screen {
            height: 100vh;
            display: flex; align-items: center; justify-content: center;
            background: var(--primary-gradient);
        }

        .upload-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            width: 450px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .upload-card h1 { font-size: 24px; margin: 10px 0; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .upload-card p { color: #666; font-size: 14px; margin-bottom: 25px; }

        .drop-area {
            border: 2px dashed #6a82fb;
            border-radius: 15px;
            padding: 40px 20px;
            margin-bottom: 25px;
            cursor: pointer;
            transition: 0.3s;
        }

        .drop-area:hover { background: #f0f4ff; }
        .drop-area img { width: 50px; margin-bottom: 15px; opacity: 0.7; }
        .drop-area span { color: #6a82fb; font-weight: 600; display: block; }
        .drop-area small { color: #999; display: block; margin-top: 5px; }

        .btn-main {
            background: var(--btn-gradient);
            color: white; border: none; padding: 12px 40px;
            border-radius: 25px; font-weight: 600; cursor: pointer;
            font-size: 16px; transition: 0.3s;
        }
        .btn-main:hover { opacity: 0.9; transform: translateY(-2px); }

        /* --- READER INTERFACE --- */
        #reader-container { height: 100vh; display: flex; flex-direction: column; position: relative; }

        .top-nav {
            position: absolute; top: 20px; left: 20px; right: 20px;
            display: flex; justify-content: space-between; align-items: center; z-index: 100;
        }

        .nav-left { display: flex; align-items: center; gap: 15px; }
        .btn-new { background: #fff; border: 1px solid #ddd; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 13px; display: flex; align-items: center; gap: 5px; }
        .page-info { background: #eee; padding: 4px 10px; border-radius: 4px; font-size: 12px; color: #555; }

        /* Search Implementation */
        .search-container { position: relative; display: flex; align-items: center; background: white; border-radius: 20px; padding: 2px 10px; border: 1px solid #ddd; }
        #search-input { border: none; outline: none; padding: 5px; font-size: 13px; width: 0; transition: 0.4s; }
        .search-container:hover #search-input, #search-input:focus { width: 150px; }

        /* Flipbook Viewport */
        .viewport { flex: 1; display: flex; align-items: center; justify-content: center; perspective: 2500px; padding-bottom: 80px; }
        .book { position: relative; width: 900px; height: 600px; transform-style: preserve-3d; transition: transform 0.5s; }
        .sheet { position: absolute; width: 50%; height: 100%; top: 0; right: 0; transform-origin: left center; transition: transform var(--flip-speed) cubic-bezier(0.645, 0.045, 0.355, 1); transform-style: preserve-3d; z-index: 1; }
        .sheet.flipped { transform: rotateY(-180deg); }
        .side { position: absolute; inset: 0; backface-visibility: hidden; background: white; border: 1px solid #eee; display: flex; align-items: center; justify-content: center; }
        .side.back { transform: rotateY(180deg); }
        canvas { width: 100%; height: 100%; object-fit: contain; }

        /* Navigation Arrows */
        .side-arrow { position: absolute; top: 50%; transform: translateY(-50%); background: transparent; border: none; cursor: pointer; color: #999; z-index: 200; transition: 0.2s; }
        .side-arrow:hover { color: #333; scale: 1.1; }
        .arrow-l { left: 40px; } .arrow-r { right: 40px; }

        /* Floating Toolbar */
        .bottom-toolbar {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
            padding: 10px 25px; border-radius: 15px; display: flex; gap: 20px; align-items: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); z-index: 100;
        }
        .tool-icon { color: #666; cursor: pointer; transition: 0.2s; width: 22px; }
        .tool-icon:hover { color: var(--accent); }

        /* Loader */
        .loader { position: fixed; inset: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 2000; }
        .spinner { width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #6a82fb; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div id="upload-screen">
        <div class="upload-card">
            <h1>ðŸ“– PDF Reader</h1>
            <p>Upload your PDF to start reading</p>
            
            <div class="drop-area" id="drop-zone">
                <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png" alt="PDF Icon">
                <span>Click to browse or drag & drop</span>
                <small>PDF files only</small>
                <input type="file" id="pdf-input" accept="application/pdf" class="hidden">
            </div>

            <button class="btn-main" onclick="document.getElementById('pdf-input').click()">Upload / Read PDF</button>
        </div>
    </div>

    <div id="reader-container" class="hidden">
        <div class="top-nav">
            <div class="nav-left">
                <button class="btn-new" onclick="location.reload()">
                    <i data-lucide="plus" size="16"></i> New File
                </button>
                <span class="page-info">page <span id="cur-p">1</span> of <span id="total-p">0</span></span>
            </div>
            
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search page number...">
                <i data-lucide="search" class="tool-icon" size="18" onclick="goToSearchPage()"></i>
            </div>
        </div>

        <button class="side-arrow arrow-l" id="prev-btn"><i data-lucide="chevron-left" size="56"></i></button>
        
        <main class="viewport">
            <div class="book" id="book-canvas"></div>
        </main>
        
        <button class="side-arrow arrow-r" id="next-btn"><i data-lucide="chevron-right" size="56"></i></button>

        <div class="bottom-toolbar">
            <i data-lucide="layout-grid" class="tool-icon" title="Thumbnails"></i>
            <i data-lucide="share-2" class="tool-icon" id="share-btn" title="Share"></i>
            <i data-lucide="printer" class="tool-icon" id="print-btn" title="Print"></i>
            <i data-lucide="download" class="tool-icon" id="dl-btn" title="Download"></i>
            <i data-lucide="zoom-in" class="tool-icon" onclick="adjustZoom(0.1)" title="Zoom In"></i>
            <i data-lucide="maximize" class="tool-icon" id="fs-btn" title="Fullscreen"></i>
        </div>
    </div>

    <div id="loader" class="loader hidden">
        <div class="spinner"></div>
        <p style="margin-top:15px; font-weight:500;">Rendering Document...</p>
    </div>

    <script>
        lucide.createIcons();
        const pdfjsLib = window['pdfjs-dist/build/pdf'];
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        let pdfDoc = null, sheetIdx = 0, sheets = [], zoomLevel = 1, currentFile = null;

        const pdfInput = document.getElementById('pdf-input');
        const dropZone = document.getElementById('drop-zone');
        const book = document.getElementById('book-canvas');
        const loader = document.getElementById('loader');

        // Logic for File Selection
        const loadFile = async (file) => {
            if (!file || file.type !== 'application/pdf') return;
            currentFile = file;
            loader.classList.remove('hidden');
            const buffer = await file.arrayBuffer();
            pdfDoc = await pdfjsLib.getDocument(buffer).promise;
            document.getElementById('total-p').textContent = pdfDoc.numPages;
            await buildBook();
            document.getElementById('upload-screen').classList.add('hidden');
            document.getElementById('reader-container').classList.remove('hidden');
            loader.classList.add('hidden');
        };

        pdfInput.onchange = (e) => loadFile(e.target.files[0]);
        dropZone.onclick = () => pdfInput.click();
        
        // Drag and Drop
        dropZone.ondragover = (e) => { e.preventDefault(); dropZone.style.background = "#f0f4ff"; };
        dropZone.ondragleave = () => { dropZone.style.background = "transparent"; };
        dropZone.ondrop = (e) => { e.preventDefault(); loadFile(e.dataTransfer.files[0]); };

        async function buildBook() {
            book.innerHTML = ''; sheets = [];
            for (let i = 1; i <= pdfDoc.numPages; i += 2) {
                const sheet = document.createElement('div');
                sheet.className = 'sheet';
                sheet.style.zIndex = Math.ceil(pdfDoc.numPages / 2) - sheets.length;
                const front = document.createElement('div'); front.className = 'side front';
                await renderPage(i, front); sheet.appendChild(front);
                const back = document.createElement('div'); back.className = 'side back';
                if (i + 1 <= pdfDoc.numPages) await renderPage(i + 1, back);
                sheet.appendChild(back);
                book.appendChild(sheet); sheets.push(sheet);
            }
        }

        async function renderPage(num, container) {
            const page = await pdfDoc.getPage(num);
            const viewport = page.getViewport({ scale: 2 });
            const canvas = document.createElement('canvas');
            canvas.height = viewport.height; canvas.width = viewport.width;
            await page.render({ canvasContext: canvas.getContext('2d'), viewport: viewport }).promise;
            container.appendChild(canvas);
        }

        // Search Implementation: Jump to page number
        function goToSearchPage() {
            const input = document.getElementById('search-input').value;
            const pageNum = parseInt(input);
            if (isNaN(pageNum) || pageNum < 1 || pageNum > pdfDoc.numPages) {
                alert("Please enter a valid page number.");
                return;
            }
            // Reset book
            sheets.forEach(s => { s.classList.remove('flipped'); s.style.zIndex = ''; });
            sheetIdx = 0;
            // Flip to target
            const targetSheet = Math.floor((pageNum - 1) / 2);
            for(let i = 0; i < targetSheet; i++) {
                next();
            }
            updateUI();
        }

        // Navigation
        const next = () => {
            if (sheetIdx < sheets.length) {
                sheets[sheetIdx].classList.add('flipped');
                sheets[sheetIdx].style.zIndex = sheetIdx + 1;
                sheetIdx++; updateUI();
            }
        };
        const prev = () => {
            if (sheetIdx > 0) {
                sheetIdx--; sheets[sheetIdx].classList.remove('flipped');
                sheets[sheetIdx].style.zIndex = sheets.length - sheetIdx;
                updateUI();
            }
        };

        document.getElementById('next-btn').onclick = next;
        document.getElementById('prev-btn').onclick = prev;

        function updateUI() {
            const p = (sheetIdx * 2) + 1;
            document.getElementById('cur-p').textContent = p > pdfDoc.numPages ? pdfDoc.numPages : p;
        }

        function adjustZoom(delta) {
            zoomLevel = Math.max(0.5, Math.min(1.5, zoomLevel + delta));
            book.style.transform = `scale(${zoomLevel})`;
        }

        // Toolbar Buttons
        document.getElementById('print-btn').onclick = () => {
            const url = URL.createObjectURL(currentFile);
            const win = window.open(url, '_blank');
            win.onload = () => win.print();
        };

        document.getElementById('share-btn').onclick = async () => {
            if (navigator.share) {
                try {
                    await navigator.share({ title: currentFile.name, text: 'Reading this PDF', url: window.location.href });
                } catch (err) { console.log("Share failed"); }
            } else { alert("Share not supported. Copy URL: " + window.location.href); }
        };

        document.getElementById('dl-btn').onclick = () => {
            const a = document.createElement('a');
            a.href = URL.createObjectURL(currentFile);
            a.download = currentFile.name;
            a.click();
        };

        document.getElementById('fs-btn').onclick = () => {
            if (!document.fullscreenElement) document.documentElement.requestFullscreen();
            else document.exitFullscreen();
        };

        window.onkeydown = (e) => {
            if (e.key === 'ArrowRight') next();
            if (e.key === 'ArrowLeft') prev();
        };
    </script>
</body>
</html>